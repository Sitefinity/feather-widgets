@using Telerik.Sitefinity.Frontend.Mvc.Helpers

<div id="masterDesigner" ng-controller="MasterDesignerCtrl">
    <script type="text/ng-template" id="editDialogContent">
         <div class="modal-header">
             <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="Cancel($event)">&times;</button>
             <h1 class="modal-title"> @Html.Raw(ViewBag.ControlName)</h1>
         </div>
         <div class="modal-body">
            <div ng-show="ShowError" class="alert alert-danger">
                <a class="close" data-dismiss="alert">x</a>
                <strong>Error!</strong> <span ng-bind="ErrorMessage"></span>
            </div>

            <div ng-show="ShowLoadingIndicator" class="s-loading m-bottom-sm"></div>

            <div id="viewsPlaceholder" ng-view></div>
           
         </div>
         <div class="modal-footer">
            <button class="btn btn-primary" ng-click="Save(false)">Save</button>
            <button class="btn btn-default" ng-click="Save(true)" ng-hide="HideSaveAllTranslations">Save All Translations</button>
            <a class="btn btn-link" data-dismiss="modal" ng-click="Cancel($event)">Cancel</a>

            <a class="btn btn-default btn-xs pull-right m-top-xs" ng-click="ChangeView()" ng-show="IsSimpleVisible" href="#/simple">Simple</a>
            <a class="btn btn-default btn-xs pull-right m-top-xs" ng-click="ChangeView()" ng-hide="IsSimpleVisible" href="#/advanced">Advanced</a>
         </div>
    </script>
   
    @*use local simple view*@
    <script type="text/ng-template" id="simple-designer-view">
        @{
            Html.RenderAction("GetDesignerPartialView", "Designer", new { widgetName = ViewBag.ControlName, viewType = "Simple" });
        }
    </script>

    @*use the default advanced view*@
    <script type="text/ng-template" id="advanced-designer-view">
        @{
            Html.RenderAction("GetDesignerPartialView", "Designer", new { widgetName = ViewBag.ControlName, viewType = "Advanced" });
        }
    </script>

</div>

@* Latest compiled and minified CSS *@
<link rel="stylesheet" href='@Url.WidgetContent("Mvc/Scripts/Bootstrap/css/bootstrap.min.css")'>
@*  Optional theme *@
<link rel="stylesheet" href='@Url.WidgetContent("Mvc/Styles/sitefinity-theme.min.css")'>

<script src='@Url.WidgetContent("Mvc/Scripts/MasterDesignerCtrl.js")'></script>
<script src='@Url.WidgetContent("Mvc/Scripts/AdvancedDesignerModule.js")'></script>
<script src='@Url.WidgetContent("Mvc/Scripts/BreadCrumbModule.js")'></script>
<script src='@Url.WidgetContent("Mvc/Scripts/SimpleDesignerModule.js")'></script>

<script src='@Url.WidgetContent("Mvc/Scripts/ShareContentService.js")'></script>
<script src='@Url.WidgetContent("Mvc/Scripts/MasterDesignerCtrlExtended.js")'></script>

<script type="text/javascript">

    var shareContentServices;
    try { shareContentServices = angular.module("shareContentServices") } catch (err) { shareContentServices = angular.module('shareContentServices', ['controlPropertyServices']); }

    //This is the place where we bootstrap the data passed by the controller. We do that by creating a angular service which will return the data object
    angular.module('shareContentServices').factory('HelperDataService', function () {
        return {
            contentItemsServiceUrl: '@Url.Content("~/Sitefinity/Services/Content/ContentItemService.svc/")'
        };
    });

    var designerModule = angular.module('designer', ['masterDesigner', 'advancedDesignerModule', 'simpleDesignerModule', 'controlPropertyServices', 'ngRoute']);

    designerModule.config(function ($routeProvider) {
        $routeProvider
                //the route points to a MVC controller action that returns a proper view
                .when('/advanced', {
                    templateUrl: 'advanced-designer-view', controller: 'AdvancedDesignerModuleCtrl'
                })
                .when('/simple', {
                    templateUrl: 'simple-designer-view', controller: 'SimpleDesignerModuleCtrl'
                })
                .when('/', {
                    templateUrl: 'simple-designer-view', controller: 'SimpleDesignerModuleCtrl'
                });
    });

    angular.bootstrap($("#masterDesigner"), ['designer']);

  
</script>
