!function(){function e(){var o="filter",u=document.getElementById("facetContainer"),s=document.getElementById("applied-filters"),l=10;if(u){u.addEventListener("change",function(e){f(e.target);var t=function(e,t){if(e){var a,n=h();t&&"input"===t.tagName.toLowerCase()&&(a=t.attributes["data-facet-key"].value);var r=!1;return t&&"input"===t.tagName.toLowerCase()&&(a=t.attributes["data-facet-key"].value,r=!t.checked),{appliedFilters:Object.keys(n).map(function(e){return{fieldName:e,filterValues:n[e]}}),lastSelectedFilterGropName:a,isDeselected:r}}}(u,e.target),a=JSON.stringify(t),n=window.location.search,r=new Querystring(n.substring(1,n.length));if(t&&t.appliedFilters&&0<t.appliedFilters.length){var i=btoa(a);r.set(o,i),d(!0)}else r.remove(o),d(!1);var c=function(e){var t=window.location.href.split("?")[0],a=document.getElementById("sf-currentPageUrl");a&&(t=a.value);return t+"?"+e.toString()}(r);!function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Content-type","application/json; charset=utf-8"),t.setRequestHeader("Accept","application/json"),document.dispatchEvent(new CustomEvent("beginLoadingSearchResults")),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status&&t.responseText){var e=(new DOMParser).parseFromString(t.responseText,"text/html");e&&(document.dispatchEvent(new CustomEvent("searchResultsLoaded",{detail:{searchResultsPageDocument:e}})),function(e){var t=e.getElementById("facetContent");document.getElementById("facetContent").innerHTML=t.innerHTML,m(),v()}(e))}},t.onerror=function(){document.dispatchEvent(new CustomEvent("searchResultsLoaded",{detail:{searchResultsPageDocument:null}}))},t.send(null)}(c),window.history.pushState({path:c},"",c)});var e=document.getElementById("sf-facet-clear-all-btn");e&&e.addEventListener("click",function(){u.querySelectorAll('input[type="checkbox"]:checked').forEach(function(e){e.checked=!1}),u.dispatchEvent(new Event("change")),s.innerText=""}),document.querySelectorAll('[id^="show-more-less"]')&&u.addEventListener("click",function(e){if(e.target&&e.target.id.startsWith("show-more-less")){var t=e.target.attributes["data-facet-type"].value,a=e.target.attributes["show-less"].value,n=e.target.attributes["show-more"].value,r="facets-group-list-"+t;!function(e,t,a,n){e.some(function(e){return e.hasAttribute("hidden")})?(e.forEach(function(e){e.removeAttribute("hidden")}),t.target.innerText=a):(e.slice(l).forEach(function(e){e.setAttribute("hidden","true")}),t.target.innerText=n)}(Array.from(document.querySelectorAll("#"+r+">li")),e,a,n)}})}function d(e){var t=document.getElementById("sf-facet-clear-all-btn");t&&(e?t.removeAttribute("hidden"):t.setAttribute("hidden","true"))}function f(e){if(e&&"input"===e.tagName.toLowerCase()){var t=e.attributes["data-facet-key"].value,a=e.attributes["data-facet-value"].value,n=e.parentElement.getElementsByTagName("label")[0].textContent,r="remove-facet-filter-"+t+"-"+a;if(e.checked){var i=function(e,t,a,n){var r=s.attributes["data-sf-filter-label-css-class"].value,i=s.attributes["data-sf-applied-filter-html-tag"].value||"span",c=document.createElement(i);c.setAttribute("class",r),c.innerText=n;var o=s.attributes["data-sf-remove-filter-css-class"].value,u=document.createElement("span");return u.setAttribute("id",e),u.setAttribute("role","button"),u.setAttribute("tabindex","0"),u.setAttribute("title","Remove"),u.setAttribute("class",o),u.setAttribute("data-facet-key",t),u.setAttribute("data-facet-value",a),u.innerText="âœ•",c.appendChild(u),c}(r,t,a,n);s.appendChild(i)}else{var c=document.getElementById(r);s.removeChild(c.parentElement)}}}function m(r){var e=window.location.search,t=new Querystring(e.substring(1,e.length)).get(o);if(t){d(!0);var a=atob(t);JSON.parse(a).appliedFilters.forEach(function(n){n.filterValues.forEach(function(e){var t="facet-checkbox-"+decodeURIComponent(n.fieldName)+"-"+decodeURIComponent(e),a=document.getElementById(t);a&&(a.checked=!0,r&&f(a))})})}}function v(){u&&function(t){return Object.keys(t).map(function(e){return{fieldName:e,filterValues:t[e]}})}(h()).forEach(function(e){var t=e.fieldName,a=document.getElementById("show-more-less-"+t);if(a){var n=a.attributes["show-less"].value,r=e.filterValues,i="facets-group-list-"+t,c=Array.from(document.querySelectorAll("#"+i+">li")),o=[];c.forEach(function(e){var t=e.getElementsByTagName("input")[0].attributes["data-facet-value"].value,a=encodeURIComponent(t);o.push(a)});for(var u=0;u<r.length;u++){var s=o.indexOf(r[u]);if(l-1<s){c.forEach(function(e){e.removeAttribute("hidden"),a.innerText=n});break}}}})}function h(){var i={},e=u.querySelectorAll('input[type="checkbox"]:checked');return e&&e.forEach(function(e){var t=e.attributes["data-facet-key"].value,a=e.attributes["data-facet-value"].value,n=encodeURIComponent(t),r=encodeURIComponent(a);i.hasOwnProperty(n)?i[n].push(r):i[n]=[r]}),i}s&&s.addEventListener("click",function(e){if(e.target&&e.target.hasAttribute("data-facet-key")){var t=e.target.parentElement;s.removeChild(t);var a="facet-checkbox-"+e.target.attributes["data-facet-key"].value+"-"+e.target.attributes["data-facet-value"].value;document.getElementById(a).checked=!1,u.dispatchEvent(new Event("change"))}}),m(!0),v()}document.addEventListener("DOMContentLoaded",function(){e()})}();
//# sourceMappingURL=facets-widget.min.js.map