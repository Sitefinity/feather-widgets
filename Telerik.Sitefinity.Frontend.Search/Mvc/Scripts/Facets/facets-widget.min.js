!function(){function e(){var c="filter",g="__sf-range__",h="DateAndTime",o=document.getElementById("facetContainer"),s=document.getElementById("applied-filters"),d=10;if(o){o.addEventListener("change",function(e){e&&e.target&&e.target.attributes["data-custom-range"]||(k(e.target),p(n(o,e.target)))});var e=document.getElementById("sf-facet-clear-all-btn");e&&e.addEventListener("click",function(){o.querySelectorAll('input[type="checkbox"]:checked').forEach(function(e){e.checked=!1});var e=o.querySelectorAll("input[data-custom-range]");e&&e.forEach(function(e){e.value=""}),s.innerText="",p(n(o,null))});var t=document.querySelectorAll('[id^="show-more-less"]'),a=document.querySelectorAll('[id^="custom-range"]');(t||a)&&o.addEventListener("click",function(e){if(e.target&&e.target.id.startsWith("show-more-less")){var t=e.target.attributes["data-facet-type"].value,a=e.target.attributes["show-less"].value,n=e.target.attributes["show-more"].value,r="facets-group-list-"+t;!function(e,t,a,n){e.some(function(e){return e.hasAttribute("hidden")})?(e.forEach(function(e){e.removeAttribute("hidden")}),t.target.innerText=a):(e.slice(d).forEach(function(e){e.setAttribute("hidden","true")}),t.target.innerText=n)}(Array.from(document.querySelectorAll("#"+r+">li")),e,a,n)}var u=e.target.id.startsWith("custom-range-btn")?e.target:e.target.closest('[id^="custom-range-btn"]');u&&function(e){var t=e.attributes["data-custom-range-name"],a=e.attributes["data-custom-range-type"];if(t&&a){var n=t.value,r=a.value;if(n&&r){var u=document.getElementById("from-"+n),c=document.getElementById("to-"+n);if(u&&c){!function(e){var t=document.getElementById("facets-group-list-"+e);if(t){t.querySelectorAll('input[type="checkbox"]:checked').forEach(function(e){e.checked=!1,k(e)})}}(n);var i=u.value,o=c.value;if(null!=i&&""!==i&&null!=o&&""!==o){var l=function(e,t,a){if(e!==h)return t+g+a;var n=new Date(t);n.setHours(0);var r=new Date(a);return r.setHours(0),n.toISOString()+g+r.toISOString()}(r,i,o),s=y(r,i,o),d="facet-checkbox-"+n+"-"+l,f=!0,m=document.getElementById(d);m&&(f=!1,m.checked=!0),E(n,l,s,f);var v=S();b(v),p(w(v,n,!1))}}}}}(u)})}function p(e){var t=JSON.stringify(e),a=window.location.search,n=new Querystring(a.substring(1,a.length));if(e&&e.appliedFilters&&0<e.appliedFilters.length){var r=btoa(t);n.set(c,r),i(!0)}else n.remove(c),i(!1);var u=function(e){var t=window.location.href.split("?")[0],a=document.getElementById("sf-currentPageUrl");a&&(t=a.value);return t+"?"+e.toString()}(n);!function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Content-type","application/json; charset=utf-8"),t.setRequestHeader("Accept","application/json"),document.dispatchEvent(new CustomEvent("beginLoadingSearchResults")),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status&&t.responseText){var e=(new DOMParser).parseFromString(t.responseText,"text/html");e&&(document.dispatchEvent(new CustomEvent("searchResultsLoaded",{detail:{searchResultsPageDocument:e}})),function(e){var t=e.getElementById("facetContent");document.getElementById("facetContent").innerHTML=t.innerHTML,m(),A()}(e))}},t.onerror=function(){document.dispatchEvent(new CustomEvent("searchResultsLoaded",{detail:{searchResultsPageDocument:null}}))},t.send(null)}(u),window.history.pushState({path:u},"",u)}function y(e,t,a){if(e!==h)return t+" - "+a;var n=new Date(t),r={month:"short",day:"numeric"},u=n.toLocaleString(void 0,r)+" "+n.getFullYear(),c=new Date(a);return u+" - "+(c.toLocaleString(void 0,r)+" "+c.getFullYear())}function b(c){document.querySelectorAll("[data-selected-custom-range]").forEach(function(e){var t=e.attributes["data-facet-value"],a=e.attributes["data-facet-key"];if(t&&a){var n=t.value,r=a.value,u={filterValue:n,isCustom:!0};c.hasOwnProperty(r)?c[r].push(u):c[r]=[u]}})}function E(e,t,a,n){var r=l(e,t);if(!(null!==document.getElementById(r))){!function(e){var t=s.querySelectorAll('[data-selected-custom-range][data-facet-key="'+e+'"]');t&&t.forEach(function(e){s.removeChild(e.parentElement)})}(e);var u=f(r,e,t,a,n);s.appendChild(u)}}function i(e){var t=document.getElementById("sf-facet-clear-all-btn");t&&(e?t.removeAttribute("hidden"):t.setAttribute("hidden","true"))}function k(e){if(e&&"input"===e.tagName.toLowerCase()&&!e.attributes["data-custom-range"]){var t=e.attributes["data-facet-key"].value,a=e.attributes["data-facet-value"].value,n=e.parentElement.getElementsByTagName("label")[0].textContent,r=l(t,a),u=document.getElementById(r);if(e.checked){var c=f(r,t,a,n,!1);s.appendChild(c),function(e){var t="[data-facet-key='"+e+"'][data-selected-custom-range]",a=document.querySelector(t);a&&s.removeChild(a.parentElement)}(t)}else s.removeChild(u.parentElement)}}function l(e,t){return"remove-facet-filter-"+e+"-"+t}function f(e,t,a,n,r){var u=s.attributes["data-sf-filter-label-css-class"].value,c=s.attributes["data-sf-applied-filter-html-tag"].value||"span",i=document.createElement(c);i.setAttribute("class",u),i.innerText=n;var o=s.attributes["data-sf-remove-filter-css-class"].value,l=document.createElement("span");return l.setAttribute("id",e),l.setAttribute("role","button"),l.setAttribute("tabindex","0"),l.setAttribute("title","Remove"),l.setAttribute("class",o),l.setAttribute("data-facet-key",t),l.setAttribute("data-facet-value",a),r&&l.setAttribute("data-selected-custom-range",!0),l.innerText="âœ•",i.appendChild(l),i}function m(s){var e=window.location.search,t=new Querystring(e.substring(1,e.length)).get(c);if(t){i(!0);var a=atob(t);JSON.parse(a).appliedFilters.forEach(function(l){l.filterValues.forEach(function(e){var t=decodeURIComponent(l.fieldName),a=decodeURIComponent(e.filterValue),n="facet-checkbox-"+t+"-"+a,r=document.getElementById(n);if(r||(n=n.replace(/\./g,","),r=document.getElementById(n)),r)r.checked=!0,s&&k(r);else{var u="facets-group-list-"+t,c=document.getElementById(u);if(c){var i=c.attributes["data-facet-type"];if(i){var o=i.value;o&&function(e,t,a){var n=document.getElementById("from-"+e),r=document.getElementById("to-"+e);if(n&&r){var u=t.split(g);if(u&&0<u.length){var c=u[0],i=u[1];if(null!=c&&null!=i){a===h&&(c=v(c),i=v(i)),n.value=c,r.value=i;var o=y(a,c,i);E(e,t,o,!0)}}}}(t,a,o)}}}})})}}function v(e){var t=new Date(e),a=t.getMonth()+1;2!==(a=a.toString()).length&&(a="0"+a);var n=t.getDate().toString();return 2!==n.length&&(n="0"+n),t.getFullYear()+"-"+a+"-"+n}function n(e,t){if(e){var a,n=S();t&&"input"===t.tagName.toLowerCase()&&(a=t.attributes["data-facet-key"].value);var r=!1;return t&&"input"===t.tagName.toLowerCase()&&(a=t.attributes["data-facet-key"].value,r=!t.checked),b(n),w(n,a,r)}}function w(t,e,a){return{appliedFilters:Object.keys(t).map(function(e){return{fieldName:e,filterValues:t[e]}}),lastSelectedFilterGropName:e,isDeselected:a}}function A(){o&&function(t){return Object.keys(t).map(function(e){return{fieldName:e,filterValues:t[e]}})}(S()).forEach(function(e){var t=e.fieldName,a=document.getElementById("show-more-less-"+t);if(a){var n=a.attributes["show-less"].value,r=e.filterValues,u="facets-group-list-"+t,c=Array.from(document.querySelectorAll("#"+u+">li")),i=[];c.forEach(function(e){var t=e.getElementsByTagName("input")[0].attributes["data-facet-value"].value,a=encodeURIComponent(t);i.push(a)});for(var o=0;o<r.length;o++){var l=i.indexOf(r[o]);if(d-1<l){c.forEach(function(e){e.removeAttribute("hidden"),a.innerText=n});break}}}})}function S(){var u={},e=o.querySelectorAll('input[type="checkbox"]:checked');return e&&e.forEach(function(e){var t=e.attributes["data-facet-key"].value,a=e.attributes["data-facet-value"].value,n=encodeURIComponent(t),r={filterValue:encodeURIComponent(a),isCustom:!1};u.hasOwnProperty(n)?u[n].push(r):u[n]=[r]}),u}s&&s.addEventListener("click",function(e){if(e.target&&e.target.hasAttribute("data-facet-key")){var t=e.target.parentElement;s.removeChild(t);var a=e.target.attributes["data-facet-key"].value,n=e.target.attributes["data-facet-value"].value;if(e.target.hasAttribute("data-selected-custom-range")){var r="facets-group-list-"+a,u=document.querySelectorAll("#"+r+" input");u&&u.forEach(function(e){e.value=""})}else{var c="facet-checkbox-"+a+"-"+n,i=document.getElementById(c);i&&(i.checked=!1)}o.dispatchEvent(new Event("change"))}}),m(!0),A()}document.addEventListener("DOMContentLoaded",function(){e()})}();
//# sourceMappingURL=facets-widget.min.js.map